!function(){"use strict";function e(){this.defaults={zoomEnable:!0,defaultIndex:0,images:[],style:"inner",boxPos:"right-top",boxW:400,boxH:400,method:"lens",cursor:"crosshair",lens:!0,zoomLevel:3,immersiveMode:"769",immersiveModeOptions:{},immersiveModeMessage:"Click to Zoom",prevThumbButton:"&#9665;",nextThumbButton:"&#9655;",thumbsPos:"bottom",thumbCol:3,thumbColPadding:4},this.setDefaults=function(e){this.defaults=angular.extend(this.defaults,e)},this.$get=function(){return this}}function o(e){return{restrict:"EA",template:'<div class="wip-image-zoom {{vm.options.style}}-style {{vm.options.thumbsPos}}-thumbs"\n     ng-class="{\n     \'active\':vm.zoomActive, \n     \'immersive-mode\':vm.immersiveModeActive && !immersive,\n     \'zoom-disabled\':!vm.options.zoomEnable,\n     \'box-style\':vm.options.style == \'box\' ,\n     \'inner-style\':vm.options.style == \'inner\'}">\n\n    <wip-image-zoom-thumbs ng-if="vm.options.thumbsPos === \'top\' && vm.images.length > 1"></wip-image-zoom-thumbs>\n\n    <div ng-hide="!vm.options.zoomEnable && immersive" class="main-image-wrapper" ng-class="{\'loading\':vm.largeImageLoading}">\n        <div class="image-zoom-tracker" wip-image-zoom-tracker></div>\n        <div class="image-zoom-lens" wip-image-zoom-lens></div>\n        <img class="main-image" ng-src="{{vm.mainImage.medium}}" image-on-load="vm.initZoom()">\n        <div class="zoom-mask"\n             ng-class="vm.options.style == \'box\'? vm.options.boxPos : \'\'"\n             wip-image-zoom-mask>\n            <img wip-image-zoom-image class="zoom-image main-image-large" image-on-load="vm.largeImageLoaded()"\n                 ng-src="{{vm.mainImage.large}}">\n        </div>\n        <div ng-if="vm.immersiveModeActive && !immersive && vm.options.immersiveModeMessage !== \'\'"\n             class="immersive-mode-message" ng-bind="vm.options.immersiveModeMessage"></div>\n    </div>\n\n    <div class="immersive-no-zoom-image-wrapper" ng-show="!vm.options.zoomEnable && immersive">\n        <img class="main-image-large" ng-src="{{vm.mainImage.large}}">\n    </div>\n\n    <wip-image-zoom-thumbs\n            ng-if="vm.options.thumbsPos === \'bottom\' && vm.images.length > 1"></wip-image-zoom-thumbs>\n</div>',replace:!0,scope:{selectedModel:"=?",selectedIndex:"=?",wipImageZoom:"=",immersive:"=?"},controllerAs:"vm",link:function(e,o,t,i){i.el=o,i.attrs=t,i.init()},controller:["$scope","$document","$window","$compile","wipImageZoomConfig",function(o,t,i,m,n){function s(){Q.options=o.wipImageZoom?angular.extend(U,o.wipImageZoom):U,a(),o.selectedIndex=Q.options.defaultIndex,o.selectedModel=Q.mainImage,C()}function a(){Q.options.images.length<=0&&(Q.options.images=[{thumb:Q.attrs.src,medium:Q.attrs.src,large:Q.attrs.src}]),Q.images=Q.options.images,Q.mainImage=Q.images[Q.options.defaultIndex]}function l(){_&&e.cancel(_),_=e(function(){c(),r(),E()},400)}function r(){Q.options.zoomEnable&&(f(),Q.zoomTracker.style.cursor=Q.options.cursor,Q.options.lens?Q.zoomLens.style.display="block":Q.zoomLens.style.display="none",p(),Q.immersiveModeActive=Q.options.immersiveMode&&Q.options.immersiveMode>i.innerWidth||"always"===Q.options.immersiveMode,Q.immersiveModeActive&&!o.immersive&&Q.zoomTracker.addEventListener("mousedown",d),(!Q.immersiveModeActive||o.immersive)&&u())}function u(){Q.zoomTracker.addEventListener("mousemove",k),Q.zoomTracker.addEventListener("touchstart",k),Q.zoomTracker.addEventListener("mouseleave",L),Q.zoomTracker.addEventListener("touchend",L),Q.zoomTracker.addEventListener("mousemove",z),Q.zoomTracker.addEventListener("touchmove",z)}function p(){Q.zoomTracker.removeEventListener("mousedown",d),Q.zoomTracker.removeEventListener("mousemove",k),Q.zoomTracker.removeEventListener("touchstart",k),Q.zoomTracker.removeEventListener("mouseleave",L),Q.zoomTracker.removeEventListener("touchend",L),Q.zoomTracker.removeEventListener("mousemove",z),Q.zoomTracker.removeEventListener("touchmove",z)}function g(){t.find("html").removeClass("wip-image-zoom-immersive-mode-enabled"),p(),Q.immersedEl.remove(),l()}function d(e){e.preventDefault(),e.stopPropagation(),o.$apply(function(){t.find("html").addClass("wip-image-zoom-immersive-mode-enabled");var e=t.find("body").eq(0);Q.immersedImageOpt=angular.extend(angular.copy(Q.options),Q.options.immersiveModeOptions),Q.immersedImageOpt.defaultIndex=o.selectedIndex,Q.immersedImageOpt.style="inner",Q.immersedEl=m('<div class="immersive-wip-image-zoom">\n    <div class="disable-immersive-mode-button" ng-click="vm.disableImmersiveMode()">&#10006;</div>\n    <img src="" wip-image-zoom="vm.immersedImageOpt" immersive="true" selected-index="selectedIndex">\n</div>\n')(o),e.append(Q.immersedEl),l()})}function c(){Q.images.length<=1||(Q.thumbsWrapperWidth=Q.thumbsWrapper.clientWidth,Q.thumbWidth=Math.round((Q.thumbsWrapperWidth+Q.options.thumbColPadding)/Q.options.thumbCol),Q.thumbsWidth=Q.thumbWidth*Q.images.length,Q.maxPosX=Q.images.length-Q.options.thumbCol,o.$evalAsync(function(){"top"===Q.options.thumbsPos?(Q.thumbsEl.style.paddingBottom=Q.options.thumbColPadding+"px",Q.thumbsEl.style.paddingTop=0):(Q.thumbsEl.style.paddingTop=Q.options.thumbColPadding+"px",Q.thumbsEl.style.paddingBottom=0);for(var e=0;e<Q.thumbsEl.children.length;e++){var o=Q.thumbsEl.children[e];o.style.width=Q.thumbWidth+"px",o.style.paddingRight=Q.options.thumbColPadding+"px"}}))}function v(){b(Q.thumbsPos+1)}function h(){b(Q.thumbsPos-1)}function b(e){e=0>e?0:e,e=e>Q.maxPosX?Q.maxPosX:e,Q.thumbsPos=e;var o=Q.thumbsPos*Q.thumbWidth*-1;Q.thumbsEl.style.transform="translate3d("+o+"px, 0px, 0)"}function f(){var e=Q.zoomTracker.getBoundingClientRect();A=e.width,$=e.height,"box"!==Q.options.style||o.immersive?(R=A,H=$,Q.zoomMaskEl.style.width="100%",Q.zoomMaskEl.style.height="100%"):(R=Q.options.boxW,H=Q.options.boxH,Q.zoomMaskEl.style.width=R+"px",Q.zoomMaskEl.style.height=H+"px"),Q.zoomImageEl.style.width="",Q.zoomImageEl.style.height="",Q.options.zoomLevel>1?(Q.zoomImageEl.style.width=A*Q.options.zoomLevel+"px",Q.zoomImageEl.style.height=$*Q.options.zoomLevel+"px"):(Q.zoomImageEl.offsetWidth<=R||Q.zoomImageEl.offsetHeight<=H)&&(Q.zoomImageEl.offsetWidth/Q.zoomImageEl.offsetHeight>1?(Q.zoomImageEl.style.height=1.5*H+"px",Q.zoomImageEl.style.width=""):(Q.zoomImageEl.style.width=1.5*R+"px",Q.zoomImageEl.style.height="")),X=Q.zoomImageEl.offsetWidth,S=Q.zoomImageEl.offsetHeight,w()}function z(e){e.preventDefault();var o="touchmove"===e.type&&e.touches&&e.touches[0];B=o&&o.pageX||e.pageX,W=o&&o.pageY||e.pageY,y(),"lens"===Q.options.method?x():I()}function x(){var e=[(X-R+1*N/G)*[V/A]],o=[(S-H+1*Y/G)*[F/$]];Q.zoomImageEl.style.transform="translate3d("+-1*e+"px,"+-1*o+"px,0)"}function I(){var e=[(X-R)*[(B-q)/A]],o=[(S-H)*[(W-D)/$]];e=q>B?0:e,o=D>W?0:o,e=B>q+A?X-R:e,o=W>D+$?S-H:o,Q.zoomImageEl.style.transform="translate3d("+-1*e+"px,"+-1*o+"px,0)"}function w(){G=A/X,N=R*G,Y=H*G,Q.zoomLens.style.width=N+"px",Q.zoomLens.style.height=Y+"px"}function y(){function e(e){return o(e)?e:9===e.nodeType&&e.defaultView}function o(e){return null!=e&&e===e.window}var t=Q.zoomTracker&&Q.zoomTracker.ownerDocument,i=e(t),m=t.documentElement,n=Q.zoomTracker.getBoundingClientRect(),s=n.top+i.pageYOffset-m.clientTop,a=n.left+i.pageXOffset-m.clientLeft;V=B-a-.5*N,F=W-s-.5*Y,V=V>A-N?A-N:V,V=0>V?0:V,F=F>$-Y?$-Y:F,F=0>F?0:F,Q.zoomLens.style.transform="translate3d("+V+"px,"+F+"px,0)"}function E(){if(!(Q.images.length<=1||Q.images.length<Q.options.thumbCol)){var e=T(),o=Q.thumbsPos+Q.options.thumbCol>e&&Q.thumbsPos<e;return o?void b(Q.thumbsPos):void b(e)}}function T(){for(var e=0;e<Q.images.length;e++)if(Q.images[e].medium===Q.mainImage.medium)return e}function k(){o.$evalAsync(function(){Q.zoomActive=!0})}function L(){o.$evalAsync(function(){Q.zoomActive=!1})}function j(e,o){angular.isDefined(e)&&e!==o&&(Q.mainImage=e,E())}function M(e,o){angular.isDefined(e)&&e!==o&&(Q.mainImage=Q.images[e],E())}function P(e){Q.largeImageLoading=!0,Q.mainImage=e,O(),o.selectedModel=angular.copy(Q.mainImage),o.selectedIndex=Q.images.indexOf(Q.mainImage),C()}function C(){J=o.$watch("selectedIndex",M,!0),K=o.$watch("selectedModel",j,!0)}function O(){K(),J()}function Z(){Q.largeImageLoading=!1,f()}var B,W,A,$,q,D,R,H,X,S,N,Y,V,F,G,J,K,Q=this,U=angular.copy(n.defaults),_=!0;Q.el={},Q.zoomTracker={},Q.zoomLens={},Q.zoomImageEl={},Q.thumbsWrapper={},Q.thumbsEl={},Q.mainImage={},Q.options={},Q.images=[],Q.zoomActive=!1,Q.largeImageLoading=!0,Q.prevThumbActive=!1,Q.nextThumbActive=!1,Q.thumbWidth=0,Q.thumbsWrapperWidth=0,Q.thumbsWidth=0,Q.thumbsPos=0,Q.immersiveModeActive=!1,Q.init=s,Q.initZoom=r,Q.initThumbs=c,Q.largeImageLoaded=Z,Q.updateMainImage=P,Q.nextThumb=v,Q.prevThumb=h,Q.disableImmersiveMode=g,angular.element(window).on("resize",function(){l()}),i.Ps&&angular.element(document).on("ps-scroll-y",function(){f()}),o.$watch(function(){return{left:Q.zoomTracker.getBoundingClientRect().left+i.scrollX,top:Q.zoomTracker.getBoundingClientRect().top+i.scrollY}},function(e,o){angular.isDefined(e)&&e!==o&&l()},!0),o.$watch("wipImageZoom",function(e,o){angular.isDefined(e)&&e!==o&&(s(),l())},!0)}]}}function t(){return{restrict:"EA",require:"^wipImageZoom",link:function(e,o,t,i){i.zoomLens=o[0]}}}function i(){return{restrict:"EA",require:"^wipImageZoom",link:function(e,o,t,i){i.zoomTracker=o[0]}}}function m(){return{restrict:"EA",require:"^wipImageZoom",link:function(e,o,t,i){i.zoomMaskEl=o[0]}}}function n(){return{restrict:"EA",require:"^wipImageZoom",link:function(e,o,t,i){i.zoomImageEl=o[0]}}}function s(){return{restrict:"EA",require:"^wipImageZoom",template:'<div class="thumbs-wrapper" ng-swipe-left="vm.nextThumb()" ng-swipe-right="vm.prevThumb()">\n    <div class="thumbs" >\n        <div class="thumb-wrapper" ng-repeat="image in vm.images">\n            <img ng-src="{{image.thumb}}" ng-click="vm.updateMainImage(image)"\n                 ng-class="{\'selected\': vm.mainImage.thumb === image.thumb}">\n        </div>\n    </div>\n</div>\n<div class="prev-button"\n     ng-if="vm.thumbsPos !== 0 && vm.images.length > vm.options.thumbCol"\n     ng-click="vm.prevThumb()"\n     ng-bind-html="vm.options.prevThumbButton">Prev\n</div>\n<div class="next-button"\n     ng-if="vm.thumbsPos !== vm.maxPosX && vm.images.length > vm.options.thumbCol"\n     ng-click="vm.nextThumb()"\n     ng-bind-html="vm.options.nextThumbButton">Next\n</div>',link:function(e,o,t,i){i.thumbsWrapper=o[0].getElementsByClassName("thumbs-wrapper")[0],i.thumbsEl=o[0].getElementsByClassName("thumbs")[0],i.initThumbs()}}}function a(e){return{restrict:"A",link:function(o,t,i){t[0].addEventListener("load",function(){o.$apply(i.imageOnLoad)},!1),t[0].addEventListener("error",function(){e.warn("image could not be loaded")})}}}a.$inject=["$log"],o.$inject=["$timeout"],angular.module("wipImageZoom",["ngSanitize","ngTouch"]).provider("wipImageZoomConfig",e).directive("imageOnLoad",a).directive("wipImageZoom",o).directive("wipImageZoomTracker",i).directive("wipImageZoomLens",t).directive("wipImageZoomMask",m).directive("wipImageZoomImage",n).directive("wipImageZoomThumbs",s)}(),function(){"use strict";function e(){var e=this;e.zoomOptions1={defaultImage:0,style:"box",boxPos:"right-top",boxW:400,boxH:400,method:"lens",cursor:"crosshair",lens:!0,zoomLevel:3,immersiveMode:"769",immersiveModeOptions:{},prevThumbButton:"&#9665;",nextThumbButton:"&#9655;",thumbsPos:"bottom",thumbCol:4,thumbColPadding:4,images:[{thumb:"assets/images/1-thumb.jpg",medium:"assets/images/1-medium.jpg",large:"assets/images/1-large.jpg"},{thumb:"assets/images/2-thumb.jpg",medium:"assets/images/2-medium.jpg",large:"assets/images/2-large.jpg"},{thumb:"assets/images/3-thumb.jpg",medium:"assets/images/3-medium.jpg",large:"assets/images/3-large.jpg"},{thumb:"assets/images/4-thumb.jpg",medium:"assets/images/4-medium.jpg",large:"assets/images/4-large.jpg"},{thumb:"assets/images/5-thumb.jpg",medium:"assets/images/5-medium.jpg",large:"assets/images/5-large.jpg"},{thumb:"assets/images/6-thumb.jpg",medium:"assets/images/6-medium.jpg",large:"assets/images/6-large.jpg"},{thumb:"assets/images/7-thumb.jpg",medium:"assets/images/7-medium.jpg",large:"assets/images/7-large.jpg"}]}}angular.module("wipImageZoom").controller("MainController",e)}(),function(){"use strict";angular.module("wipImageZoomDemo",["wipImageZoom"])}(),function(){"use strict";function e(){}angular.module("wipImageZoomDemo").run(e)}(),function(){"use strict";function e(e){e.setDefaults({})}e.$inject=["wipImageZoomConfigProvider"],angular.module("wipImageZoomDemo").config(e)}(),angular.module("wipImageZoom").run(["$templateCache",function(e){e.put("app/main/main.html",'<div class=container><h1 class=page-title>wip-image-zoom</h1><div class=demo-preview><img src=assets/images/1-medium.jpg wip-image-zoom=vm.zoomOptions1 selected-model=vm.selected selected-index=vm.selectedIndex><!--  <div style="width:300px">\r\n              <img src="http://lorempixel.com/output/nature-h-c-100-200-9.jpg" wip-image-zoom=\'{\r\n                 "images"              : [\r\n                  {\r\n                      thumb : "http://lorempixel.com/output/nature-h-c-100-200-9.jpg",\r\n                      medium: "http://lorempixel.com/output/nature-h-c-100-200-9.jpg",\r\n                      large : "http://lorempixel.com/output/nature-h-c-200-400-9.jpg"\r\n                  },\r\n                  {\r\n                      thumb : "http://lorempixel.com/output/nature-h-c-100-150-5.jpg",\r\n                      medium: "http://lorempixel.com/output/nature-h-c-100-150-5.jpg",\r\n                      large : "http://lorempixel.com/output/nature-h-c-600-900-5.jpg"\r\n                  },\r\n                  {\r\n                      thumb : "http://lorempixel.com/output/nature-q-c-200-100-6.jpg",\r\n                      medium: "http://lorempixel.com/output/nature-q-c-200-100-6.jpg",\r\n                      large : "http://lorempixel.com/output/nature-q-c-400-200-6.jpg"\r\n                  },\r\n                  {\r\n                      thumb : "http://lorempixel.com/output/nature-q-c-200-100-6.jpg",\r\n                      medium: "http://lorempixel.com/output/nature-q-c-400-200-6.jpg",\r\n                      large : "http://lorempixel.com/output/nature-q-c-300-200-6.jpg"\r\n                  },\r\n                  {\r\n                      thumb : "http://lorempixel.com/output/nature-q-c-200-200-3.jpg",\r\n                      medium: "http://lorempixel.com/output/nature-q-c-200-200-3.jpg",\r\n                      large : "http://lorempixel.com/output/nature-q-c-400-400-3.jpg"\r\n                  }\r\n                  ]\r\n              }\'>\r\n          </div>\r\n          --></div><section><div class=demo-settings><button ng-repeat="image in vm.zoomOptions1.images" ng-click="vm.selected = image">Image {{$index +1 }}</button><div class=setting><label>Style:</label><select ng-model=vm.zoomOptions1.style><option value=box>Box</option><option value=inner>Inner</option></select></div><div class=setting><label>Box Style Position:</label><select ng-model=vm.zoomOptions1.boxPos><option value=right-top>Right Top</option><option value=right-middle>Right Middle</option><option value=right-bottom>Right Bottom</option><option value=left-top>Left Top</option><option value=left-middle>Left Middle</option><option value=left-bottom>Left Bottom</option><option value=bottom-left>Bottom Left</option><option value=bottom-center>Bottom Center</option><option value=bottom-right>Bottom Right</option><option value=top-left>Top Left</option><option value=top-center>Top Center</option><option value=top-right>Top Right</option></select></div><div class=setting><label>Box Width:</label><input ng-model=vm.zoomOptions1.boxW type=number step=1 min=0></div><div class=setting><label>Box Height:</label><input ng-model=vm.zoomOptions1.boxH type=number step=1 min=0></div><div class=setting><label>Method:</label><select ng-model=vm.zoomOptions1.method><option value=lens>Lens</option><option value=pointer>Pointer</option></select></div><div class=setting><label>Cursor:</label><select ng-model=vm.zoomOptions1.cursor><option value=default>Default</option><option value=pointer>Pointer</option><option value=crosshair>Crosshair</option><option value=move>Move</option><option value=zoom-in>Zoom in</option><option value=none>None</option></select></div><div class=setting><label>Show Lens:</label><input ng-model=vm.zoomOptions1.lens type=checkbox></div><div class=setting><label>Zoom Level:</label><input ng-model=vm.zoomOptions1.zoomLevel type=number step=.5 min=0></div><div class=setting><label>Immersive Mode:</label><input ng-model=vm.zoomOptions1.immersiveMode><div class=detail>false or 0 for disable, max width(px) for trigger</div></div><div class=setting><label>Thumbs Position:</label><select ng-model=vm.zoomOptions1.thumbsPos><option value=top>top</option><option value=bottom>bottom</option></select></div><div class=setting><label>Previous Thumb Button:</label><input ng-model=vm.zoomOptions1.prevThumbButton type=text></div><div class=setting><label>Next Thumb Button:</label><input ng-model=vm.zoomOptions1.nextThumbButton type=text></div><div class=setting><label>Thumb Column Count:</label><input ng-model=vm.zoomOptions1.thumbCol type=number step=1 min=1></div><div class=setting><label>Thumb Column Padding (px):</label><input ng-model=vm.zoomOptions1.thumbColPadding type=number step=1 min=0></div></div><div class=demo-json><h4>Options</h4><pre>{{vm.zoomOptions1 | json}}</pre><h4>Selected Model</h4><pre>{{vm.selected | json}}</pre><h4>SelectedIndex</h4><pre>{{vm.selectedIndex}}</pre></div></section></div>')}]);
//# sourceMappingURL=../maps/scripts/app.js.map
